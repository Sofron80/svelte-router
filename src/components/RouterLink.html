<a href='#{{ to }}' class="{{active}}" on:click='navigate($e, to)'>
  {{ yield }}
</a>

<script>
  import pathToRegexp from 'path-to-regexp'
  import history from '~utils/history'
  const activedClassName = 'router-link-active'
  
  export default {
    data () {
      return {
        to: '/',
        active: '',
        event: null
      }
    },
    oncreate () {
      this.setActivedClass()

      const _this = this
      this.set({
        event () {
          _this.setActivedClass()
        }
      })

      window.addEventListener('hashchange', this.get('event'), false)
    },
    ondestroy () {
      window.removeEventListener('hashchange', this.get('event'), false)
    },
    methods: {
      navigate ($e, to) {
        if ($e && e.preventDefault) $e.preventDefault()
        if (to) {
          const { pathname } = history.location

          if (pathname !== to) {
            history.push(to)
          }
        }
      },

      setActivedClass () {
        const { pathname } = history.location
        if (pathname === this.get('to')) {
          this.set({ active: activedClassName })
        } else {
          this.set({ active: '' })
        }
      }
    }
  }
</script>
